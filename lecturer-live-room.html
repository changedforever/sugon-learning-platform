<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>ç›´æ’­é—´ - HIECO å…‰åˆæŠ€æœ¯æ”¯æŒå¹³å°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- å›¾æ ‡åº“ -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    body {
      background: #000;
      overflow: hidden;
    }
    .live-player {
      background: #000;
      position: relative;
    }
    .control-panel {
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
    }
    .gift-item {
      animation: floatUp 3s ease-in-out forwards;
    }
    @keyframes floatUp {
      0% { transform: translateY(0) scale(1); opacity: 1; }
      100% { transform: translateY(-100px) scale(0.5); opacity: 0; }
    }
    .audience-list {
      max-height: calc(100vh - 200px);
      overflow-y: auto;
    }
    .audience-list::-webkit-scrollbar {
      display: none;
    }
    .gift-shop {
      max-height: 300px;
      overflow-y: auto;
    }
    .chat-message {
      animation: slideIn 0.3s ease-out;
    }
    @keyframes slideIn {
      from { transform: translateX(-100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    /* å³ä¾§æ æ”¶èµ·å±•å¼€æ ·å¼ */
    .sidebar-collapsed {
      width: 0 !important;
      overflow: hidden;
    }
    .expand-btn-visible {
      opacity: 1 !important;
      pointer-events: auto !important;
    }
    /* å‚ç›´éŸ³é‡è°ƒèŠ‚æ¡æ ·å¼ */
    .vertical-slider {
      -webkit-appearance: slider-vertical;
      writing-mode: bt-lr;
      -webkit-writing-mode: vertical-lr;
      width: 8px;
      height: 100px;
    }
    input[type=range].vertical-slider {
      -webkit-appearance: slider-vertical;
      width: 15px;
      height: 100px;
      padding: 0 5px;
    }
  </style>
</head>
<body class="bg-black text-white">

<!-- ç›´æ’­é—´ä¸»ä½“ -->
<div class="flex h-screen bg-black">
  <!-- å·¦ä¾§ï¼šç›´æ’­æ’­æ”¾åŒºåŸŸ -->
  <div class="flex-1 relative">
    <!-- å³ä¾§æ æ”¶èµ·æ—¶æ˜¾ç¤ºçš„å±•å¼€æŒ‰é’® -->
    <button id="expandSidebarBtn" class="absolute top-4 right-4 z-20 w-auto h-10 rounded-full bg-gray-800 bg-opacity-70 flex items-center justify-center hover:bg-opacity-90 transition-opacity duration-300 opacity-0 pointer-events-none px-3">
      <i class="fa fa-chevron-left text-white mr-1"></i>
      <i class="fa fa-users text-white text-xs"></i>
      <span class="text-white text-xs ml-1"><span id="expandBtnViewerCount">1.2ä¸‡</span></span>
    </button>
    
    <!-- ç›´æ’­è§†é¢‘æ’­æ”¾å™¨ -->
    <div class="live-player w-full h-full flex items-center justify-center">
      <video id="liveVideo" class="w-full h-full object-cover" controls poster="https://images.unsplash.com/photo-1579546929662-711aa81148cf?auto=format&fit=crop&w=1950&q=80">
        <source src="#" type="video/mp4">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾
      </video>
      
      <!-- åˆ‡æ¢ -->
      <div class="switch absolute top-24 left-4 z-20">
        <a href="live-room.html" class="bg-[#2D874B] hover:bg-[#24703a] text-white px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 shadow-lg hover:shadow-xl">
          <i class="fa fa-exchange"></i>
          åˆ‡æ¢åˆ°è§‚ä¼—ç›´æ’­é—´
        </a>
      </div>

      <!-- ç›´æ’­é—´æ ‡é¢˜å’Œä¸»æ’­ä¿¡æ¯ -->
      <div class="absolute top-4 left-4 z-20">
        <h1 class="text-xl font-bold mb-1">AIæŠ€æœ¯å‰æ²¿åˆ†äº« - æ·±åº¦å­¦ä¹ å®æˆ˜</h1>
        <div class="flex items-center text-sm opacity-90">
          <div class="w-6 h-6 rounded-full bg-gradient-to-r from-red-500 to-pink-500 mr-2 flex items-center justify-center">
            <i class="fa fa-circle text-[8px] text-white"></i>
          </div>
          <span>ç›´æ’­ä¸­</span>
          <span class="ml-3">æ›™å…‰æŠ€æœ¯ä¸“å®¶</span>
        </div>
      </div>
      

      
      <!-- æ§åˆ¶é¢æ¿ -->
      <div class="absolute bottom-4 left-0 right-0 z-20 control-panel px-4 py-3">
        <div class="flex items-center justify-between">
          <!-- å·¦ä¾§æ§åˆ¶æŒ‰é’® -->
          <div class="flex items-center space-x-4">
            <!-- <button id="playPauseBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition">
              <i class="fa fa-play"></i>
            </button> -->
            <button id="refreshBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition">
              <i class="fa fa-sync"></i>
            </button>
            <button id="giftBtn" class="w-10 h-10 rounded-full bg-gradient-to-r from-pink-500 to-red-500 flex items-center justify-center hover:from-pink-600 hover:to-red-600 transition">
              <i class="fa fa-gift"></i>
            </button>
            <button id="micLinkBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition" title="åœ¨çº¿è¿éº¦">
              <i class="fa fa-microphone"></i>
            </button>
            <button id="shareBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition">
              <i class="fa fa-share"></i>
            </button>
            <button id="screenShareBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition">
              <i class="fa fa-desktop"></i>
            </button>
            <button id="raiseHandBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition">
              <i class="fa fa-hand-paper"></i>
            </button>
          </div>
          
          <!-- å³ä¾§æ§åˆ¶æŒ‰é’® -->
          <div class="flex items-center space-x-4">
            <button id="rotateBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition">
              <i class="fa fa-exchange-alt"></i>
            </button>
            <button id="danmakuBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition">
              <i class="fa fa-comment"></i>
            </button>
            <div class="relative group">
              <button id="volumeBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition">
                <i class="fa fa-volume-up"></i>
              </button>
              <!-- éŸ³é‡è°ƒèŠ‚æ¡ -->
              <div class="absolute bottom-full right-0 mb-2 w-8 h-24 bg-gray-800 bg-opacity-80 rounded-lg p-2 hidden group-hover:block">
                <input type="range" id="volumeSlider" min="0" max="100" value="80" orient="vertical" class="w-full h-full bg-gray-600 rounded-lg appearance-none cursor-pointer vertical-slider">
              </div>
            </div>
            <button id="pipBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition">
              <i class="fa fa-compress"></i>
            </button>
            <button id="fullscreenBtn" class="w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition">
              <i class="fa fa-expand"></i>
            </button>
          </div>
        </div>
        
        <!-- è¿›åº¦æ¡ -->
        <div class="mt-3">
          <div class="w-full bg-gray-700 rounded-full h-1">
            <div class="bg-red-500 h-1 rounded-full" style="width: 25%"></div>
          </div>
        </div>
      </div>
      
      <!-- ç¤¼ç‰©é£è¡ŒåŠ¨ç”»åŒºåŸŸ -->
      <div id="giftAnimationArea" class="absolute top-0 left-0 w-full h-full pointer-events-none z-10">
      </div>
    </div>
  </div>
  
  <!-- å³ä¾§ï¼šäº’åŠ¨é¢æ¿ -->
  <div id="sidebar" class="w-80 bg-gray-900 bg-opacity-90 backdrop-blur-sm flex flex-col h-full transition-all duration-300 ease-in-out">
    <!-- å³ä¾§æ é¡¶éƒ¨æ§åˆ¶æŒ‰é’® -->
    <div class="flex justify-between items-center border-b border-gray-700 flex-shrink-0 p-3">
      <h3 class="text-sm font-semibold">
        <i class="fa fa-users mr-1"></i>
        è§‚çœ‹äººæ•°ï¼š<span id="sidebarViewerCount">1.2ä¸‡</span>äºº
      </h3>
      <button id="collapseSidebarBtn" class="w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center hover:bg-gray-600">
        <i class="fa fa-chevron-right text-white text-xs"></i>
      </button>
    </div>
    <!-- èŠå¤©å®¤å’Œè§‚ä¼—åˆ—è¡¨åˆ‡æ¢ -->
    <div class="flex border-b border-gray-700 flex-shrink-0">
      <button id="coursewareTab" class="tab-button flex-1 py-3 text-center font-medium border-b-2 border-red-500 text-red-500">è¯¦æƒ…</button>
      <button id="chatTab" class="tab-button flex-1 py-3 text-center font-medium text-gray-400 hover:text-white">èŠå¤©</button>
      <button id="audienceTab" class="tab-button flex-1 py-3 text-center font-medium text-gray-400 hover:text-white">è§‚ä¼—</button>
      <button id="rankTab" class="tab-button flex-1 py-3 text-center font-medium text-gray-400 hover:text-white hidden">æ’è¡Œæ¦œ</button>
    </div>
    
    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="flex-1 flex flex-col min-h-0 overflow-hidden">
      <!-- è¯¾ä»¶å†…å®¹åŒºåŸŸ -->
      <div id="coursewareContent" class="tab-content hidden flex-1 overflow-hidden flex flex-col">
        <!-- Tab å¯¼èˆª -->
        <div class="flex border-b border-gray-700 flex-shrink-0 bg-gray-800">
          <button id="introTab" class="courseware-tab-btn flex-1 py-3 text-center font-medium border-b-2 border-red-500 text-red-500">ç›´æ’­ä»‹ç»</button>
          <button id="outlineTab" class="courseware-tab-btn flex-1 py-3 text-center font-medium text-gray-400 hover:text-white">ç›´æ’­å¤§çº²</button>
          <button id="materialsTab" class="courseware-tab-btn flex-1 py-3 text-center font-medium text-gray-400 hover:text-white">å…³è”èµ„æ–™</button>
          <button id="replayTab" class="courseware-tab-btn flex-1 py-3 text-center font-medium text-gray-400 hover:text-white">å›æ”¾</button>
        </div>
        
        <div class="flex-1 overflow-y-auto audience-list">
          <!-- ç›´æ’­ä»‹ç» -->
          <div id="introContent" class="courseware-tab-content p-3">
            <p class="text-sm leading-relaxed">
              æœ¬åœºç›´æ’­é¢å‘ HIECO åˆä½œä¼™ä¼´ç”Ÿæ€ä¸­çš„äº‘æ¶æ„å¸ˆã€è§£å†³æ–¹æ¡ˆé¡¾é—®å’Œ DevOps å·¥ç¨‹å¸ˆï¼Œ
              ä»å®é™…é¡¹ç›®æ¡ˆä¾‹å‡ºå‘ï¼Œæ¢³ç†ä¸€å¥—å¯å¤åˆ¶çš„äº‘åŸç”Ÿæ¶æ„è®¾è®¡æ–¹æ³•è®ºï¼Œå¹¶é€šè¿‡ç°åœº DEMO
              å±•ç¤ºå®Œæ•´è½åœ°è¿‡ç¨‹ã€‚ç›´æ’­ç»“æŸåï¼Œå°†æä¾›å½•æ’­å›çœ‹å’Œèµ„æ–™ä¸‹è½½ã€‚
            </p>
            <ul class="mt-3 text-sm space-y-1 list-disc pl-5">
              <li>é€‚åˆäººç¾¤ï¼šäº‘æ¶æ„å¸ˆ / è§£å†³æ–¹æ¡ˆé¡¾é—® / DevOps å·¥ç¨‹å¸ˆ</li>
              <li>é…å¥—èµ„æºï¼šæ¼”ç¤ºé¡¹ç›®ä»£ç ã€æ¶æ„å›¾æ¨¡æ¿ã€æœ€ä½³å®è·µæ‰‹å†Œ</li>
              <li>å…³è”è®¤è¯ï¼šä¼™ä¼´äº‘æ¶æ„å·¥ç¨‹å¸ˆï¼ˆP-Cloud Architectï¼‰ä¸“ä¸šè®¤è¯</li>
            </ul>
          </div>
          
          <!-- ç›´æ’­å¤§çº² -->
          <div id="outlineContent" class="courseware-tab-content hidden p-3">
            <div class="space-y-4">
              <div class="border-l-4 border-red-500 pl-4">
                <h3 class="text-sm font-semibold text-white mb-1">ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼€åœºä¸åŸºç¡€æ¦‚å¿µ</h3>
                <p class="text-xs text-gray-400">19:00â€“19:15</p>
                <ul class="mt-2 text-xs text-gray-400 space-y-1 list-disc pl-4">
                  <li>äº‘åŸç”Ÿå‘å±•å†ç¨‹ä¸æ ¸å¿ƒä»·å€¼</li>
                  <li>å¾®æœåŠ¡æ¶æ„æ¼”è¿›ä¸æŒ‘æˆ˜</li>
                  <li>å®¹å™¨åŒ–æŠ€æœ¯åŸºç¡€å›é¡¾</li>
                </ul>
              </div>
              
              <div class="border-l-4 border-red-500 pl-4">
                <h3 class="text-sm font-semibold text-white mb-1">ç¬¬äºŒéƒ¨åˆ†ï¼šæ¶æ„è®¾è®¡æ–¹æ³•è®º</h3>
                <p class="text-xs text-gray-400">19:15â€“20:00</p>
                <ul class="mt-2 text-xs text-gray-400 space-y-1 list-disc pl-4">
                  <li>æœåŠ¡æ‹†åˆ†åŸåˆ™ä¸è¾¹ç•Œè®¾è®¡</li>
                  <li>æ•°æ®ä¸€è‡´æ€§ä¿éšœæ–¹æ¡ˆ</li>
                  <li>å¯è§‚æµ‹æ€§ä½“ç³»å»ºè®¾</li>
                  <li>å®‰å…¨ä¸åˆè§„æ€§è€ƒè™‘</li>
                </ul>
              </div>
              
              <div class="border-l-4 border-red-500 pl-4">
                <h3 class="text-sm font-semibold text-white mb-1">ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®æˆ˜æ¼”ç¤º</h3>
                <p class="text-xs text-gray-400">20:00â€“20:40</p>
                <ul class="mt-2 text-xs text-gray-400 space-y-1 list-disc pl-4">
                  <li>ä»å•ä½“åº”ç”¨è¿ç§»åˆ°å¾®æœåŠ¡</li>
                  <li>Kubernetes éƒ¨ç½²æœ€ä½³å®è·µ</li>
                  <li>CI/CD æµæ°´çº¿é…ç½®</li>
                  <li>ç›‘æ§å‘Šè­¦é…ç½®æ¼”ç¤º</li>
                </ul>
              </div>
              
              <div class="border-l-4 border-red-500 pl-4">
                <h3 class="text-sm font-semibold text-white mb-1">ç¬¬å››éƒ¨åˆ†ï¼šæ€»ç»“ä¸äº’åŠ¨</h3>
                <p class="text-xs text-gray-400">20:40â€“21:00</p>
                <ul class="mt-2 text-xs text-gray-400 space-y-1 list-disc pl-4">
                  <li>å¸¸è§é—®é¢˜è§£ç­”</li>
                  <li>åç»­å­¦ä¹ è·¯å¾„å»ºè®®</li>
                  <li>èµ„æ–™ä¸‹è½½ä¸æŠ€æœ¯æ”¯æŒ</li>
                </ul>
              </div>
            </div>
          </div>
          
          <!-- å…³è”èµ„æ–™ -->
          <div id="materialsContent" class="courseware-tab-content hidden p-3">
            <div class="space-y-3">
              <div class="flex items-center justify-between p-3 rounded-lg bg-gray-800 border border-gray-700">
                <div class="flex items-center gap-3">
                  <i class="fa fa-file-code text-red-500 text-lg"></i>
                  <div>
                    <h3 class="text-sm font-semibold text-white">æ¼”ç¤ºé¡¹ç›®æºç </h3>
                    <p class="text-xs text-gray-400">åŒ…å«å®Œæ•´çš„å¾®æœåŠ¡æ¶æ„ç¤ºä¾‹ä»£ç </p>
                  </div>
                </div>
                <a href="#" class="text-red-500 text-xs font-medium hover:underline">ä¸‹è½½</a>
              </div>
              
              <div class="flex items-center justify-between p-3 rounded-lg bg-gray-800 border border-gray-700">
                <div class="flex items-center gap-3">
                  <i class="fa fa-diagram-project text-red-500 text-lg"></i>
                  <div>
                    <h3 class="text-sm font-semibold text-white">æ¶æ„å›¾æ¨¡æ¿</h3>
                    <p class="text-xs text-gray-400">äº‘åŸç”Ÿæ¶æ„è®¾è®¡å¸¸ç”¨æ¨¡æ¿</p>
                  </div>
                </div>
                <a href="#" class="text-red-500 text-xs font-medium hover:underline">ä¸‹è½½</a>
              </div>
              
              <div class="flex items-center justify-between p-3 rounded-lg bg-gray-800 border border-gray-700">
                <div class="flex items-center gap-3">
                  <i class="fa fa-book text-red-500 text-lg"></i>
                  <div>
                    <h3 class="text-sm font-semibold text-white">æœ€ä½³å®è·µæ‰‹å†Œ</h3>
                    <p class="text-xs text-gray-400">äº‘åŸç”Ÿè½åœ°æœ€ä½³å®è·µæŒ‡å—</p>
                  </div>
                </div>
                <a href="#" class="text-red-500 text-xs font-medium hover:underline">ä¸‹è½½</a>
              </div>
              
              <div class="flex items-center justify-between p-3 rounded-lg bg-gray-800 border border-gray-700">
                <div class="flex items-center gap-3">
                  <i class="fa fa-video text-red-500 text-lg"></i>
                  <div>
                    <h3 class="text-sm font-semibold text-white">ç›´æ’­å½•æ’­è§†é¢‘</h3>
                    <p class="text-xs text-gray-400">å®Œæ•´ç›´æ’­è¿‡ç¨‹å½•æ’­æ–‡ä»¶</p>
                  </div>
                </div>
                <a href="#" class="text-red-500 text-xs font-medium hover:underline">è§‚çœ‹</a>
              </div>
            </div>
          </div>
          
          <!-- å›æ”¾å†…å®¹ -->
          <div id="replayContent" class="courseware-tab-content hidden p-3">
            <div class="space-y-3">
              <div class="flex items-center justify-between p-3 rounded-lg bg-gray-800 border border-gray-700">
                <div class="flex items-center gap-3">
                  <i class="fa fa-play-circle text-red-500 text-lg"></i>
                  <div>
                    <h3 class="text-sm font-semibold text-white">AIæŠ€æœ¯å‰æ²¿åˆ†äº« - æ·±åº¦å­¦ä¹ å®æˆ˜</h3>
                    <p class="text-xs text-gray-400">2023-12-15 19:00-21:00</p>
                  </div>
                </div>
                <a href="#" class="text-red-500 text-xs font-medium hover:underline">è§‚çœ‹</a>
              </div>
              
              <div class="flex items-center justify-between p-3 rounded-lg bg-gray-800 border border-gray-700">
                <div class="flex items-center gap-3">
                  <i class="fa fa-play-circle text-red-500 text-lg"></i>
                  <div>
                    <h3 class="text-sm font-semibold text-white">äº‘åŸç”Ÿæ¶æ„è®¾è®¡æ–¹æ³•è®º</h3>
                    <p class="text-xs text-gray-400">2023-12-08 19:30-20:30</p>
                  </div>
                </div>
                <a href="#" class="text-red-500 text-xs font-medium hover:underline">è§‚çœ‹</a>
              </div>
              
              <div class="flex items-center justify-between p-3 rounded-lg bg-gray-800 border border-gray-700">
                <div class="flex items-center gap-3">
                  <i class="fa fa-play-circle text-red-500 text-lg"></i>
                  <div>
                    <h3 class="text-sm font-semibold text-white">å®¹å™¨åŒ–æŠ€æœ¯æ·±åº¦è§£æ</h3>
                    <p class="text-xs text-gray-400">2023-12-01 20:00-21:30</p>
                  </div>
                </div>
                <a href="#" class="text-red-500 text-xs font-medium hover:underline">è§‚çœ‹</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- èŠå¤©å†…å®¹åŒºåŸŸ -->
      <div id="chatContent" class="tab-content flex-1 flex flex-col">
        <!-- èŠå¤©æ¶ˆæ¯åˆ—è¡¨ -->
        <div id="chatMessages" class="flex-1 p-3 audience-list">
          <div class="chat-message mb-2 flex items-start">
            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=40&q=80" alt="User" class="w-6 h-6 rounded-full mr-2 mt-0.5">
            <div>
              <div class="text-xs text-red-400">æŠ€æœ¯å°ç™½</div>
              <div class="text-sm">è€å¸ˆè®²å¾—çœŸå¥½ï¼Œå—ç›ŠåŒªæµ…ï¼</div>
            </div>
          </div>
          
          <div class="chat-message mb-2 flex items-start">
            <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=40&q=80" alt="User" class="w-6 h-6 rounded-full mr-2 mt-0.5">
            <div>
              <div class="text-xs text-blue-400">ä»£ç è¾¾äºº</div>
              <div class="text-sm">è¯·é—®è¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ€ä¹ˆç®—ï¼Ÿ</div>
            </div>
          </div>
          
          <div class="chat-message mb-2 flex items-start">
            <img src="https://images.unsplash.com/photo-1560250097-0b93528c311a?auto=format&fit=crop&w=40&q=80" alt="User" class="w-6 h-6 rounded-full mr-2 mt-0.5">
            <div>
              <div class="text-xs text-green-400">ç®—æ³•ä¸“å®¶</div>
              <div class="text-sm">å…³æ³¨äº†ï¼ŒæœŸå¾…æ›´å¤šå¹²è´§ï¼</div>
            </div>
          </div>
          
          <div class="chat-message mb-2 flex items-start">
            <img src="https://images.unsplash.com/photo-1491637639811-60e2756e1df7?auto=format&fit=crop&w=40&q=80" alt="User" class="w-6 h-6 rounded-full mr-2 mt-0.5">
            <div>
              <div class="text-xs text-yellow-400">æ¶æ„å¸ˆ</div>
              <div class="text-sm">666666ï¼Œè®²å¾—å¤ªæ£’äº†ï¼</div>
            </div>
          </div>
        </div>
        
        <!-- å‘é€æ¶ˆæ¯è¾“å…¥æ¡† -->
        <div class="p-3 border-t border-gray-700 flex-shrink-0">
          <div class="flex items-center">
            <input type="text" placeholder="è¯´ç‚¹ä»€ä¹ˆ..." class="flex-1 bg-gray-800 rounded-l-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
            <button class="bg-red-500 hover:bg-red-600 rounded-r-full px-4 py-2 font-medium">å‘é€</button>
          </div>
        </div>
      </div>
      
      <!-- è§‚ä¼—åˆ—è¡¨ -->
      <div id="audienceContent" class="tab-content hidden flex-1 overflow-hidden flex flex-col">
        <div class="p-3 flex-1 audience-list">
          <h3 class="font-semibold mb-3 flex items-center">
            <i class="fa fa-users text-red-500 mr-2"></i>
            åœ¨çº¿è§‚ä¼— <span class="text-red-500 ml-1">12,458</span>
          </h3>
          <div class="flex items-center mb-2">
            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
            <div class="flex-1">
              <div class="text-sm">æŠ€æœ¯å°ç™½</div>
            </div>
            <div class="text-xs text-gray-400">åˆšåˆšåŠ å…¥</div>
          </div>
          
          <div class="flex items-center mb-2">
            <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
            <div class="flex-1">
              <div class="text-sm">ä»£ç è¾¾äºº</div>
            </div>
            <div class="text-xs text-gray-400">5åˆ†é’Ÿå‰</div>
          </div>
          
          <div class="flex items-center mb-2">
            <img src="https://images.unsplash.com/photo-1560250097-0b93528c311a?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
            <div class="flex-1">
              <div class="text-sm">ç®—æ³•ä¸“å®¶</div>
            </div>
            <div class="text-xs text-gray-400">8åˆ†é’Ÿå‰</div>
          </div>
          
          <div class="flex items-center mb-2">
            <img src="https://images.unsplash.com/photo-1491637639811-60e2756e1df7?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
            <div class="flex-1">
              <div class="text-sm">æ¶æ„å¸ˆ</div>
            </div>
            <div class="text-xs text-gray-400">12åˆ†é’Ÿå‰</div>
          </div>
          
          <div class="flex items-center mb-2">
            <img src="https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
            <div class="flex-1">
              <div class="text-sm">æ•°æ®ç§‘å­¦å®¶</div>
            </div>
            <div class="text-xs text-gray-400">15åˆ†é’Ÿå‰</div>
          </div>
          
          <div class="flex items-center mb-2">
            <img src="https://images.unsplash.com/photo-1554384645-13eab165c24b?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
            <div class="flex-1">
              <div class="text-sm">äº§å“ç»ç†</div>
            </div>
            <div class="text-xs text-gray-400">18åˆ†é’Ÿå‰</div>
          </div>
          
          <div class="flex items-center mb-2">
            <img src="https://images.unsplash.com/photo-1504593811423-6dd665756598?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
            <div class="flex-1">
              <div class="text-sm">è®¾è®¡å¸ˆ</div>
            </div>
            <div class="text-xs text-gray-400">22åˆ†é’Ÿå‰</div>
          </div>
        </div>
      </div>
      
      <!-- æ’è¡Œæ¦œå†…å®¹ -->
      <div id="rankContent" class="tab-content hidden flex-1 overflow-hidden flex flex-col">
        <div class="p-3 flex-1 audience-list">
          <h3 class="font-semibold mb-3 flex items-center">
            <i class="fa fa-trophy text-yellow-500 mr-2"></i>
            è´¡çŒ®æ’è¡Œæ¦œ
          </h3>
          <div class="mb-3">
            <div class="flex items-center bg-gradient-to-r from-yellow-500/20 to-yellow-600/20 p-2 rounded-lg">
              <div class="w-6 h-6 rounded-full bg-yellow-500 text-white flex items-center justify-center text-xs font-bold mr-2">1</div>
              <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
              <div class="flex-1">
                <div class="text-sm">æŠ€æœ¯å°ç™½</div>
              </div>
              <div class="text-xs text-yellow-400">è´¡çŒ®å€¼: 15,240</div>
            </div>
          </div>
          
          <div class="mb-3">
            <div class="flex items-center bg-gradient-to-r from-gray-400/20 to-gray-500/20 p-2 rounded-lg">
              <div class="w-6 h-6 rounded-full bg-gray-400 text-white flex items-center justify-center text-xs font-bold mr-2">2</div>
              <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
              <div class="flex-1">
                <div class="text-sm">ä»£ç è¾¾äºº</div>
              </div>
              <div class="text-xs text-gray-400">è´¡çŒ®å€¼: 12,890</div>
            </div>
          </div>
          
          <div class="mb-3">
            <div class="flex items-center bg-gradient-to-r from-amber-700/20 to-amber-800/20 p-2 rounded-lg">
              <div class="w-6 h-6 rounded-full bg-amber-700 text-white flex items-center justify-center text-xs font-bold mr-2">3</div>
              <img src="https://images.unsplash.com/photo-1560250097-0b93528c311a?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
              <div class="flex-1">
                <div class="text-sm">ç®—æ³•ä¸“å®¶</div>
              </div>
              <div class="text-xs text-amber-400">è´¡çŒ®å€¼: 10,750</div>
            </div>
          </div>
          
          <div class="mb-3">
            <div class="flex items-center p-2 rounded-lg hover:bg-gray-800/50">
              <div class="w-6 h-6 rounded-full bg-gray-600 text-white flex items-center justify-center text-xs font-bold mr-2">4</div>
              <img src="https://images.unsplash.com/photo-1491637639811-60e2756e1df7?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
              <div class="flex-1">
                <div class="text-sm">æ¶æ„å¸ˆ</div>
              </div>
              <div class="text-xs text-gray-400">è´¡çŒ®å€¼: 8,920</div>
            </div>
          </div>
          
          <div class="mb-3">
            <div class="flex items-center p-2 rounded-lg hover:bg-gray-800/50">
              <div class="w-6 h-6 rounded-full bg-gray-600 text-white flex items-center justify-center text-xs font-bold mr-2">5</div>
              <img src="https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
              <div class="flex-1">
                <div class="text-sm">æ•°æ®ç§‘å­¦å®¶</div>
              </div>
              <div class="text-xs text-gray-400">è´¡çŒ®å€¼: 7,650</div>
            </div>
          </div>
          
          <div class="mb-3">
            <div class="flex items-center p-2 rounded-lg hover:bg-gray-800/50">
              <div class="w-6 h-6 rounded-full bg-gray-600 text-white flex items-center justify-center text-xs font-bold mr-2">6</div>
              <img src="https://images.unsplash.com/photo-1554384645-13eab165c24b?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
              <div class="flex-1">
                <div class="text-sm">äº§å“ç»ç†</div>
              </div>
              <div class="text-xs text-gray-400">è´¡çŒ®å€¼: 6,340</div>
            </div>
          </div>
          
          <div class="mb-3">
            <div class="flex items-center p-2 rounded-lg hover:bg-gray-800/50">
              <div class="w-6 h-6 rounded-full bg-gray-600 text-white flex items-center justify-center text-xs font-bold mr-2">7</div>
              <img src="https://images.unsplash.com/photo-1504593811423-6dd665756598?auto=format&fit=crop&w=40&q=80" alt="User" class="w-8 h-8 rounded-full mr-2">
              <div class="flex-1">
                <div class="text-sm">è®¾è®¡å¸ˆ</div>
              </div>
              <div class="text-xs text-gray-400">è´¡çŒ®å€¼: 5,210</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ç¤¼ç‰©å¼¹çª— -->
<div id="giftModal" class="fixed inset-0 z-[999] hidden">
  <!-- é®ç½© -->
  <div id="giftModalBackdrop" class="absolute inset-0 bg-black/60"></div>
  <!-- å¼¹çª—å†…å®¹ -->
  <div class="absolute inset-0 flex items-center justify-center p-4">
    <div class="w-full max-w-md rounded-2xl bg-white shadow-2xl overflow-hidden">
      <div class="px-4 py-3 border-b border-gray-200 flex items-center justify-between">
        <div class="text-sm font-semibold text-gray-800">é€‰æ‹©ç¤¼ç‰©</div>
        <button id="giftModalClose" class="h-8 w-8 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 flex items-center justify-center">
          <i class="fa fa-times"></i>
        </button>
      </div>

      <div class="p-4">
        <div class="text-xs text-gray-500 mb-3">ç‚¹å‡»é€‰æ‹©ä¸€ç§ç¤¼ç‰©åå†èµ é€</div>
        <div id="giftGrid" class="grid grid-cols-3 gap-3">
          <button class="gift-option border border-gray-200 rounded-xl p-3 hover:border-red-400 hover:bg-red-50 transition text-left" data-gift="å’–å•¡">
            <div class="text-lg">â˜•</div>
            <div class="text-xs text-gray-700 mt-1">å’–å•¡</div>
          </button>
          <button class="gift-option border border-gray-200 rounded-xl p-3 hover:border-red-400 hover:bg-red-50 transition text-left" data-gift="çˆ±å¿ƒ">
            <div class="text-lg">â¤ï¸</div>
            <div class="text-xs text-gray-700 mt-1">çˆ±å¿ƒ</div>
          </button>
          <button class="gift-option border border-gray-200 rounded-xl p-3 hover:border-red-400 hover:bg-red-50 transition text-left" data-gift="æ˜Ÿæ˜Ÿ">
            <div class="text-lg">â­</div>
            <div class="text-xs text-gray-700 mt-1">æ˜Ÿæ˜Ÿ</div>
          </button>
          <button class="gift-option border border-gray-200 rounded-xl p-3 hover:border-red-400 hover:bg-red-50 transition text-left" data-gift="é’»çŸ³">
            <div class="text-lg">ğŸ’</div>
            <div class="text-xs text-gray-700 mt-1">é’»çŸ³</div>
          </button>
          <button class="gift-option border border-gray-200 rounded-xl p-3 hover:border-red-400 hover:bg-red-50 transition text-left" data-gift="ç«ç®­">
            <div class="text-lg">ğŸš€</div>
            <div class="text-xs text-gray-700 mt-1">ç«ç®­</div>
          </button>
          <button class="gift-option border border-gray-200 rounded-xl p-3 hover:border-red-400 hover:bg-red-50 transition text-left" data-gift="çš‡å† ">
            <div class="text-lg">ğŸ‘‘</div>
            <div class="text-xs text-gray-700 mt-1">çš‡å† </div>
          </button>
        </div>
      </div>

      <div class="px-4 py-3 border-t border-gray-200 flex items-center justify-between bg-gray-50">
        <div class="text-xs text-gray-600">
          å·²é€‰ï¼š<span id="selectedGiftText" class="font-semibold text-gray-800">æœªé€‰æ‹©</span>
        </div>
        <div class="flex gap-2">
          <!-- <button id="giftCancelBtn" class="px-3 py-2 text-xs rounded-xl border border-gray-300 bg-white hover:bg-gray-100">å–æ¶ˆ</button> -->
          <button id="giftSendBtn" class="px-3 py-2 text-xs rounded-xl bg-[#B01F24] text-white hover:opacity-90 disabled:opacity-40 disabled:cursor-not-allowed" disabled>èµ é€</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- è¿éº¦å¼¹çª—ï¼ˆä»…é¡µé¢æ•ˆæœï¼‰ -->
<div id="micLinkModal" class="fixed inset-0 z-[1000] hidden">
  <div id="micLinkBackdrop" class="absolute inset-0 bg-black/60"></div>
  <div class="absolute inset-0 flex items-center justify-center p-4">
    <div class="w-full max-w-sm rounded-2xl bg-white shadow-2xl overflow-hidden">
      <div class="px-4 py-3 border-b border-gray-200 flex items-center justify-between">
        <div class="text-sm font-semibold text-gray-800">åœ¨çº¿è¿éº¦</div>
        <button id="micLinkClose" class="h-8 w-8 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 flex items-center justify-center">
          <i class="fa fa-times"></i>
        </button>
      </div>

      <div class="p-4 space-y-3">
        <div class="flex items-center gap-3">
          <div class="h-10 w-10 rounded-full bg-gradient-to-r from-red-500 to-pink-500 flex items-center justify-center text-white">
            <i class="fa fa-headset"></i>
          </div>
          <div class="flex-1">
            <div class="text-sm font-medium text-gray-800">ä¸ä¸»æ’­è¿éº¦</div>
            <div id="micLinkStatusText" class="text-xs text-gray-500">æœªè¿éº¦</div>
          </div>
          <span id="micLinkBadge" class="text-[11px] px-2 py-1 rounded-full border border-gray-300 text-gray-600 bg-gray-50">ç©ºé—²</span>
        </div>

        <!-- ä¼ªâ€œéŸ³é¢‘æ³¢å½¢/è¿éº¦ä¸­â€å±•ç¤º -->
        <div id="micLinkWave" class="hidden rounded-xl border border-gray-200 bg-gray-50 p-3">
          <div class="text-xs text-gray-600 mb-2">è¿éº¦ä¸­ï¼ˆç¤ºæ„ï¼‰</div>
          <div class="flex items-end gap-1 h-10">
            <div class="w-1.5 bg-[#B01F24] rounded" style="height: 40%"></div>
            <div class="w-1.5 bg-[#B01F24] rounded" style="height: 80%"></div>
            <div class="w-1.5 bg-[#B01F24] rounded" style="height: 55%"></div>
            <div class="w-1.5 bg-[#B01F24] rounded" style="height: 90%"></div>
            <div class="w-1.5 bg-[#B01F24] rounded" style="height: 60%"></div>
            <div class="w-1.5 bg-[#B01F24] rounded" style="height: 75%"></div>
            <div class="w-1.5 bg-[#B01F24] rounded" style="height: 45%"></div>
            <div class="w-1.5 bg-[#B01F24] rounded" style="height: 85%"></div>
          </div>
        </div>
      </div>

      <div class="px-4 py-3 border-t border-gray-200 flex items-center justify-end gap-2 bg-gray-50">
        <button id="micLinkHangupBtn" class="px-3 py-2 text-xs rounded-xl bg-[#B01F24] text-white hover:bg-[#8f191d] transition hidden">æŒ‚æ–­</button>
        <button id="micLinkApplyBtn" class="px-3 py-2 text-xs rounded-xl bg-[#2D874B] text-white hover:opacity-90">ç”³è¯·è¿éº¦</button>
      </div>
    </div>
  </div>
</div>

<script>


  // å…¨å±æ§åˆ¶
  const fullscreenBtn = document.getElementById('fullscreenBtn');
  fullscreenBtn.addEventListener('click', () => {
    const elem = document.documentElement;
    if (!document.fullscreenElement) {
      if (elem.requestFullscreen) {
        elem.requestFullscreen();
      } else if (elem.mozRequestFullScreen) { /* Firefox */
        elem.mozRequestFullScreen();
      } else if (elem.webkitRequestFullscreen) { /* Chrome, Safari & Opera */
        elem.webkitRequestFullscreen();
      } else if (elem.msRequestFullscreen) { /* IE/Edge */
        elem.msRequestFullscreen();
      }
    } else {
      if (document.exitFullscreen) {
        document.exitFullscreen();
      } else if (document.mozCancelFullScreen) { /* Firefox */
        document.mozCancelFullScreen();
      } else if (document.webkitExitFullscreen) { /* Chrome, Safari & Opera */
        document.webkitExitFullscreen();
      } else if (document.msExitFullscreen) { /* IE/Edge */
        document.msExitFullscreen();
      }
    }
  });

  // å®æ—¶æ›´æ–°è§‚ä¼—æ•°
  setInterval(() => {
    const sidebarViewerCount = document.getElementById('sidebarViewerCount');
    const expandBtnViewerCount = document.getElementById('expandBtnViewerCount');
    
    // ä½¿ç”¨å›ºå®šå€¼æˆ–æ¨¡æ‹Ÿæ•°æ®ï¼Œå› ä¸ºæˆ‘ä»¬åˆ é™¤äº†åŸå§‹çš„viewerCountå…ƒç´ 
    const current = 12000; // ä½¿ç”¨å›ºå®šçš„åˆå§‹å€¼
    const increment = Math.floor(Math.random() * 10);
    const newCount = current + increment;
    const formattedCount = newCount.toLocaleString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    
    if(sidebarViewerCount) {
      sidebarViewerCount.textContent = formattedCount;
    }
    if(expandBtnViewerCount) {
      expandBtnViewerCount.textContent = formattedCount;
    }
  }, 5000);

  // æ¨¡æ‹Ÿæ–°æ¶ˆæ¯
  setInterval(() => {
    const messages = [
      { user: 'æ–°åŒå­¦', text: 'åˆšè¿›æ¥ï¼Œé”™è¿‡äº†å¼€å¤´ï¼Œèƒ½è®²è®²é‡ç‚¹å—ï¼Ÿ', color: 'text-purple-400' },
      { user: 'è€ç²‰ä¸', text: 'æ¯æœŸç›´æ’­éƒ½ä¸é”™è¿‡ï¼Œæ„Ÿè°¢è€å¸ˆåˆ†äº«ï¼', color: 'text-blue-400' },
      { user: 'å­¦ä¹ è€…', text: 'è¿™ä¸ªçŸ¥è¯†ç‚¹è®°ä½äº†ï¼Œæ”¶è—äº†ï¼', color: 'text-green-400' },
      { user: 'å¼€å‘è€…', text: 'ä»£ç å¯ä»¥è´´å‡ºæ¥çœ‹çœ‹å—ï¼Ÿ', color: 'text-yellow-400' },
      { user: 'æ¶æ„å¸ˆ', text: 'ç”Ÿäº§ç¯å¢ƒæ€ä¹ˆéƒ¨ç½²æ¯”è¾ƒç¨³å®šï¼Ÿ', color: 'text-red-400' }
    ];
    
    const randomMessage = messages[Math.floor(Math.random() * messages.length)];
    const chatMessages = document.getElementById('chatMessages');
    
    const messageDiv = document.createElement('div');
    messageDiv.className = 'chat-message mb-2 flex items-start animate-slideIn';
    messageDiv.innerHTML = `
      <img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=40&q=80" alt="User" class="w-6 h-6 rounded-full mr-2 mt-0.5">
      <div>
        <div class="text-xs ${randomMessage.color}">${randomMessage.user}</div>
        <div class="text-sm">${randomMessage.text}</div>
      </div>
    `;
    
    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }, 3000);

  // ç¤¼ç‰©åŠ¨ç”»
  function showGiftAnimation(giftName, userName) {
    const giftArea = document.getElementById('giftAnimationArea');
    const giftDiv = document.createElement('div');
    giftDiv.className = 'gift-item absolute left-1/4 bottom-20 w-48 h-16 bg-gradient-to-r from-pink-500 to-yellow-500 rounded-lg p-2 flex items-center';
    giftDiv.innerHTML = `
      <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=40&q=80" alt="User" class="w-12 h-12 rounded-full mr-2">
      <div>
        <div class="text-xs font-bold">${userName}</div>
        <div class="text-xs">é€å‡º ${giftName}</div>
      </div>
    `;
    
    // éšæœºä½ç½®
    const leftPos = 10 + Math.random() * 30;
    giftDiv.style.left = `${leftPos}%`;
    
    giftArea.appendChild(giftDiv);
    
    // 3ç§’åç§»é™¤
    setTimeout(() => {
      giftDiv.remove();
    }, 3000);
  }

  // giftBtnï¼šå¼¹çª—é€‰æ‹©ç¤¼ç‰©å¹¶èµ é€
  const giftBtn = document.getElementById('giftBtn');
  const giftModal = document.getElementById('giftModal');
  const giftModalBackdrop = document.getElementById('giftModalBackdrop');
  const giftModalClose = document.getElementById('giftModalClose');
  const giftCancelBtn = document.getElementById('giftCancelBtn');
  const giftSendBtn = document.getElementById('giftSendBtn');
  const selectedGiftText = document.getElementById('selectedGiftText');
  const giftOptions = document.querySelectorAll('#giftGrid .gift-option');
  const micLinkBtn = document.getElementById('micLinkBtn');

  let selectedGiftName = '';

  function openGiftModal() {
    selectedGiftName = '';
    selectedGiftText.textContent = 'æœªé€‰æ‹©';
    giftSendBtn.disabled = true;
    giftOptions.forEach(btn => btn.classList.remove('ring-2', 'ring-[#B01F24]', 'border-[#B01F24]'));
    giftModal.classList.remove('hidden');
  }

  function closeGiftModal() {
    giftModal.classList.add('hidden');
  }

  if (giftBtn) giftBtn.addEventListener('click', openGiftModal);
  if (giftModalBackdrop) giftModalBackdrop.addEventListener('click', closeGiftModal);
  if (giftModalClose) giftModalClose.addEventListener('click', closeGiftModal);
  if (giftCancelBtn) giftCancelBtn.addEventListener('click', closeGiftModal);
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && giftModal && !giftModal.classList.contains('hidden')) {
      closeGiftModal();
    }
  });

  // åœ¨çº¿è¿éº¦ï¼ˆä»…é¡µé¢æ•ˆæœï¼‰
  const micLinkModal = document.getElementById('micLinkModal');
  const micLinkBackdrop = document.getElementById('micLinkBackdrop');
  const micLinkClose = document.getElementById('micLinkClose');
  const micLinkStatusText = document.getElementById('micLinkStatusText');
  const micLinkBadge = document.getElementById('micLinkBadge');
  const micLinkWave = document.getElementById('micLinkWave');
  const micLinkApplyBtn = document.getElementById('micLinkApplyBtn');
  const micLinkHangupBtn = document.getElementById('micLinkHangupBtn');
  let micLinkState = 'idle'; // idle | connecting | connected
  let micLinkTimer = null;

  function setMicLinkState(next) {
    micLinkState = next;
    if (!micLinkStatusText || !micLinkBadge || !micLinkWave || !micLinkApplyBtn || !micLinkHangupBtn) return;

    if (micLinkTimer) {
      clearTimeout(micLinkTimer);
      micLinkTimer = null;
    }

    if (micLinkState === 'idle') {
      micLinkStatusText.textContent = 'æœªè¿éº¦';
      micLinkBadge.textContent = 'ç©ºé—²';
      micLinkBadge.className = 'text-[11px] px-2 py-1 rounded-full border border-gray-300 text-gray-600 bg-gray-50';
      micLinkWave.classList.add('hidden');
      micLinkApplyBtn.disabled = false;
      micLinkApplyBtn.textContent = 'ç”³è¯·è¿éº¦';
      micLinkHangupBtn.classList.add('hidden');
      return;
    }

    if (micLinkState === 'connecting') {
      micLinkStatusText.textContent = 'ç”³è¯·ä¸­...';
      micLinkBadge.textContent = 'è¿æ¥ä¸­';
      micLinkBadge.className = 'text-[11px] px-2 py-1 rounded-full border border-amber-300 text-amber-700 bg-amber-50';
      micLinkWave.classList.add('hidden');
      micLinkApplyBtn.disabled = true;
      micLinkApplyBtn.textContent = 'ç”³è¯·ä¸­...';
      micLinkHangupBtn.classList.add('hidden');

      // ä»…æ¼”ç¤ºï¼š1.2 ç§’åè‡ªåŠ¨â€œè¿ä¸Šâ€
      micLinkTimer = setTimeout(() => setMicLinkState('connected'), 1200);
      return;
    }

    if (micLinkState === 'connected') {
      micLinkStatusText.textContent = 'å·²è¿éº¦ï¼ˆæ¼”ç¤ºï¼‰';
      micLinkBadge.textContent = 'è¿éº¦ä¸­';
      micLinkBadge.className = 'text-[11px] px-2 py-1 rounded-full border border-emerald-300 text-emerald-700 bg-emerald-50';
      micLinkWave.classList.remove('hidden');
      micLinkApplyBtn.disabled = true;
      micLinkApplyBtn.textContent = 'å·²è¿éº¦';
      micLinkHangupBtn.classList.remove('hidden');
    }
  }

  function openMicLinkModal() {
    if (!micLinkModal) return;
    micLinkModal.classList.remove('hidden');
    setMicLinkState('idle');
  }
  function closeMicLinkModal() {
    if (!micLinkModal) return;
    micLinkModal.classList.add('hidden');
  }

  if (micLinkBtn) micLinkBtn.addEventListener('click', openMicLinkModal);
  if (micLinkBackdrop) micLinkBackdrop.addEventListener('click', closeMicLinkModal);
  if (micLinkClose) micLinkClose.addEventListener('click', closeMicLinkModal);
  if (micLinkApplyBtn) micLinkApplyBtn.addEventListener('click', () => setMicLinkState('connecting'));
  if (micLinkHangupBtn) micLinkHangupBtn.addEventListener('click', () => setMicLinkState('idle'));
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && micLinkModal && !micLinkModal.classList.contains('hidden')) {
      closeMicLinkModal();
    }
  });

  giftOptions.forEach(btn => {
    btn.addEventListener('click', () => {
      selectedGiftName = btn.dataset.gift || '';
      selectedGiftText.textContent = selectedGiftName || 'æœªé€‰æ‹©';
      giftSendBtn.disabled = !selectedGiftName;
      giftOptions.forEach(b => b.classList.remove('ring-2', 'ring-[#B01F24]', 'border-[#B01F24]'));
      btn.classList.add('ring-2', 'ring-[#B01F24]', 'border-[#B01F24]');
    });
  });

  if (giftSendBtn) {
    giftSendBtn.addEventListener('click', () => {
      if (!selectedGiftName) return;
      // è§¦å‘ç¤¼ç‰©åŠ¨ç”»
      showGiftAnimation(selectedGiftName, 'æˆ‘');

      // åŒæ­¥å†™å…¥èŠå¤©å®¤ï¼ˆæ¨¡æ‹Ÿï¼‰
      const chatMessages = document.getElementById('chatMessages');
      if (chatMessages) {
        const messageDiv = document.createElement('div');
        messageDiv.className = 'chat-message mb-2 flex items-start animate-slideIn';
        messageDiv.innerHTML = `
          <img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=40&q=80" alt="User" class="w-6 h-6 rounded-full mr-2 mt-0.5">
          <div>
            <div class="text-xs text-emerald-400">æˆ‘</div>
            <div class="text-sm">é€å‡º ${selectedGiftName}</div>
          </div>
        `;
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      closeGiftModal();
    });
  }
  
  // æ ‡ç­¾åˆ‡æ¢åŠŸèƒ½
  document.addEventListener('DOMContentLoaded', function() {
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');
    
    // é»˜è®¤æ˜¾ç¤ºè¯¾ä»¶å†…å®¹
    document.getElementById('coursewareContent').classList.remove('hidden');
    
    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„æ´»åŠ¨çŠ¶æ€
        tabButtons.forEach(btn => {
          btn.classList.remove('text-red-500', 'border-red-500');
          btn.classList.add('text-gray-400');
          btn.classList.remove('hover:text-white'); // é˜²æ­¢æ‚¬åœæ ·å¼å½±å“
        });
        
        // ä¸ºå½“å‰æŒ‰é’®æ·»åŠ æ´»åŠ¨çŠ¶æ€
        button.classList.remove('text-gray-400');
        button.classList.add('text-red-500', 'border-red-500');
        
        // è·å–æŒ‰é’®å¯¹åº”çš„æ ‡ç­¾ID
        const tabId = button.id.replace('Tab', 'Content');
        
        // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
        tabContents.forEach(content => {
          content.classList.add('hidden');
        });
        
        // æ˜¾ç¤ºå½“å‰å†…å®¹åŒºåŸŸ
        document.getElementById(tabId).classList.remove('hidden');
      });
    });
    
    // è¯¾ä»¶å†…éƒ¨æ ‡ç­¾åˆ‡æ¢åŠŸèƒ½
    const coursewareTabButtons = document.querySelectorAll('.courseware-tab-btn');
    const coursewareTabContents = document.querySelectorAll('.courseware-tab-content');
    
    // é»˜è®¤æ˜¾ç¤ºç›´æ’­ä»‹ç»å†…å®¹
    document.getElementById('introContent').classList.remove('hidden');
    
    coursewareTabButtons.forEach(button => {
      button.addEventListener('click', () => {
        // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„æ´»åŠ¨çŠ¶æ€
        coursewareTabButtons.forEach(btn => {
          btn.classList.remove('text-red-500', 'border-red-500');
          btn.classList.add('text-gray-400');
          btn.classList.remove('hover:text-white'); // é˜²æ­¢æ‚¬åœæ ·å¼å½±å“
        });
        
        // ä¸ºå½“å‰æŒ‰é’®æ·»åŠ æ´»åŠ¨çŠ¶æ€
        button.classList.remove('text-gray-400');
        button.classList.add('text-red-500', 'border-red-500');
        
        // è·å–æŒ‰é’®å¯¹åº”çš„æ ‡ç­¾ID
        const tabId = button.id.replace('Tab', 'Content');
        
        // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
        coursewareTabContents.forEach(content => {
          content.classList.add('hidden');
        });
        
        // æ˜¾ç¤ºå½“å‰å†…å®¹åŒºåŸŸ
        document.getElementById(tabId).classList.remove('hidden');
      });
    });
    
    // ä¸ºå›æ”¾æ ‡ç­¾æ·»åŠ å•ç‹¬çš„ç‚¹å‡»äº‹ä»¶å¤„ç†
    const replayTabButton = document.getElementById('replayTab');
    if(replayTabButton) {
      replayTabButton.addEventListener('click', () => {
        // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„æ´»åŠ¨çŠ¶æ€
        coursewareTabButtons.forEach(btn => {
          btn.classList.remove('text-red-500', 'border-red-500');
          btn.classList.add('text-gray-400');
          btn.classList.remove('hover:text-white'); // é˜²æ­¢æ‚¬åœæ ·å¼å½±å“
        });
        
        // ä¸ºå½“å‰æŒ‰é’®æ·»åŠ æ´»åŠ¨çŠ¶æ€
        replayTabButton.classList.remove('text-gray-400');
        replayTabButton.classList.add('text-red-500', 'border-red-500');
        
        // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
        coursewareTabContents.forEach(content => {
          content.classList.add('hidden');
        });
        
        // æ˜¾ç¤ºå›æ”¾å†…å®¹åŒºåŸŸ
        document.getElementById('replayContent').classList.remove('hidden');
      });
    }
    
    // æ·»åŠ å›æ”¾åŠŸèƒ½ç›¸å…³é€»è¾‘
    const replayItems = document.querySelectorAll('#replayContent .flex');
    replayItems.forEach(item => {
      item.addEventListener('click', function() {
        const videoLink = this.querySelector('a');
        if (videoLink) {
          // è¿™é‡Œå¯ä»¥æ·»åŠ è·³è½¬åˆ°å›æ”¾è§†é¢‘çš„é€»è¾‘
          console.log('è·³è½¬åˆ°å›æ”¾è§†é¢‘');
        }
      });
    });
    
    // å³ä¾§æ æ”¶èµ·/å±•å¼€åŠŸèƒ½
    const sidebar = document.getElementById('sidebar');
    const collapseBtn = document.getElementById('collapseSidebarBtn');
    const expandBtn = document.getElementById('expandSidebarBtn');
    
    if(collapseBtn && expandBtn) {
      // æ”¶èµ·å³ä¾§æ 
      collapseBtn.addEventListener('click', function() {
        sidebar.classList.add('sidebar-collapsed');
        expandBtn.classList.add('expand-btn-visible');
      });
      
      // å±•å¼€å³ä¾§æ 
      expandBtn.addEventListener('click', function() {
        sidebar.classList.remove('sidebar-collapsed');
        expandBtn.classList.remove('expand-btn-visible');
      });
    }
    
    // æ’­æ”¾å™¨åŠŸèƒ½æŒ‰é’®
    const videoPlayer = document.getElementById('liveVideo');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const refreshBtn = document.getElementById('refreshBtn');
    const rotateBtn = document.getElementById('rotateBtn');
    const danmakuBtn = document.getElementById('danmakuBtn');
    const volumeBtn = document.getElementById('volumeBtn');
    const volumeSlider = document.getElementById('volumeSlider');
    const pipBtn = document.getElementById('pipBtn');
    
    // åˆ·æ–°åŠŸèƒ½
    if(refreshBtn) {
      refreshBtn.addEventListener('click', function() {
        // æ‰§è¡Œé¡µé¢åˆ·æ–°æ“ä½œ
        window.location.reload();
      });
    }
    
    // æ’­æ”¾/æš‚åœåŠŸèƒ½
    if(playPauseBtn) {
      // åˆå§‹çŠ¶æ€ä¸ºæš‚åœçŠ¶æ€ï¼Œæ˜¾ç¤ºæ’­æ”¾å›¾æ ‡
      playPauseBtn.innerHTML = '<i class="fa fa-play"></i>';
      
      playPauseBtn.addEventListener('click', function() {
        if(videoPlayer.paused) {
          videoPlayer.play();
          playPauseBtn.innerHTML = '<i class="fa fa-pause"></i>';
        } else {
          videoPlayer.pause();
          playPauseBtn.innerHTML = '<i class="fa fa-play"></i>';
        }
      });
      
      // ç›‘å¬è§†é¢‘æ’­æ”¾/æš‚åœçŠ¶æ€å˜åŒ–ï¼ŒåŒæ­¥æŒ‰é’®çŠ¶æ€
      videoPlayer.addEventListener('play', function() {
        playPauseBtn.innerHTML = '<i class="fa fa-pause"></i>';
      });
      
      videoPlayer.addEventListener('pause', function() {
        playPauseBtn.innerHTML = '<i class="fa fa-play"></i>';
      });
    }
    
    // æ—‹è½¬åŠŸèƒ½
    if(rotateBtn) {
      let rotationAngle = 0;
      rotateBtn.addEventListener('click', function() {
        rotationAngle += 90;
        videoPlayer.style.transform = `rotate(${rotationAngle}deg)`;
      });
    }
    
    // å¼¹å¹•åŠŸèƒ½
    if(danmakuBtn) {
      danmakuBtn.addEventListener('click', function() {
        // å¼¹å¹•åŠŸèƒ½çš„å®ç°
        alert('å¼¹å¹•åŠŸèƒ½å·²å¼€å¯');
      });
    }
    
    // éŸ³é‡æ§åˆ¶åŠŸèƒ½
    if(volumeBtn && volumeSlider) {
      // åˆå§‹è®¾ç½®éŸ³é‡
      videoPlayer.volume = volumeSlider.value / 100;
      
      // ç‚¹å‡»é™éŸ³æŒ‰é’®åˆ‡æ¢é™éŸ³çŠ¶æ€
      volumeBtn.addEventListener('click', function() {
        if(videoPlayer.muted) {
          videoPlayer.muted = false;
          volumeBtn.innerHTML = '<i class="fa fa-volume-up"></i>';
        } else {
          videoPlayer.muted = true;
          volumeBtn.innerHTML = '<i class="fa fa-volume-mute"></i>';
        }
      });
      
      // éŸ³é‡æ»‘å—å˜åŒ–
      volumeSlider.addEventListener('input', function() {
        videoPlayer.volume = volumeSlider.value / 100;
        if(videoPlayer.volume === 0) {
          videoPlayer.muted = true;
          volumeBtn.innerHTML = '<i class="fa fa-volume-mute"></i>';
        } else {
          videoPlayer.muted = false;
          volumeBtn.innerHTML = '<i class="fa fa-volume-up"></i>';
        }
      });
    }
    
    // ç”»ä¸­ç”»åŠŸèƒ½
    if(pipBtn) {
      pipBtn.addEventListener('click', async function() {
        try {
          if (videoPlayer.requestPictureInPicture) {
            await videoPlayer.requestPictureInPicture();
          } else {
            alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒç”»ä¸­ç”»åŠŸèƒ½');
          }
        } catch (error) {
          console.error('ç”»ä¸­ç”»åŠŸèƒ½é”™è¯¯:', error);
        }
      });
    }
     // åˆ†äº«æŒ‰é’®åŠŸèƒ½ - å¤åˆ¶é“¾æ¥
   const shareBtn = document.getElementById('shareBtn');
   if(shareBtn) {
     shareBtn.addEventListener('click', async function() {
       try {
         // å°è¯•ä½¿ç”¨ Clipboard API
         if (navigator.clipboard) {
           await navigator.clipboard.writeText(window.location.href);
           // æ˜¾ç¤ºä¸´æ—¶æç¤º
           const originalHTML = shareBtn.innerHTML;
           shareBtn.innerHTML = '<i class="fa fa-check"></i>';
           setTimeout(() => {
            shareBtn.innerHTML = originalHTML;
          }, 2000);
         } else {
           // é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨ä¼ ç»Ÿçš„ execCommand æ–¹æ³•
           const textArea = document.createElement('textarea');
           textArea.value = window.location.href;
           document.body.appendChild(textArea);
           textArea.select();
           document.execCommand('copy');
           document.body.removeChild(textArea);
           
           // æ˜¾ç¤ºä¸´æ—¶æç¤º
           const originalHTML = shareBtn.innerHTML;
           shareBtn.innerHTML = '<i class="fa fa-check"></i>';
           setTimeout(() => {
            shareBtn.innerHTML = originalHTML;
          }, 2000);
         }
       } catch (err) {
         console.error('å¤åˆ¶é“¾æ¥å¤±è´¥:', err);
         alert('é“¾æ¥å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
       }
     });
   }
   
   // å±å¹•åˆ†äº«åŠŸèƒ½
   const screenShareBtn = document.getElementById('screenShareBtn');
   if(screenShareBtn) {
     screenShareBtn.addEventListener('click', async function() {
       try {
         // è¯·æ±‚å±å¹•å…±äº«
         const stream = await navigator.mediaDevices.getDisplayMedia({ 
           video: { mediaSource: 'screen' }
         });
         
         // æ˜¾ç¤ºä¸´æ—¶æç¤º
         const originalHTML = screenShareBtn.innerHTML;
         screenShareBtn.innerHTML = '<i class="fa fa-stop"></i>';
         
         // ç›‘å¬æµç»“æŸäº‹ä»¶ï¼Œæ¢å¤åŸå§‹å›¾æ ‡
         stream.getTracks()[0].onended = function() {
           screenShareBtn.innerHTML = originalHTML;
         };
         
       } catch (err) {
         console.error('å±å¹•åˆ†äº«å¤±è´¥:', err);
         alert('å±å¹•åˆ†äº«åŠŸèƒ½éœ€è¦HTTPSç¯å¢ƒæˆ–æœ¬åœ°ç¯å¢ƒï¼Œä¸”æµè§ˆå™¨éœ€æ”¯æŒæ­¤åŠŸèƒ½');
       }
     });
   }
   
   // ä¸¾æ‰‹åŠŸèƒ½
   const raiseHandBtn = document.getElementById('raiseHandBtn');
   if(raiseHandBtn) {
     raiseHandBtn.addEventListener('click', function() {
       // æ˜¾ç¤ºä¸¾æ‰‹çŠ¶æ€
       const originalHTML = raiseHandBtn.innerHTML;
       const originalClass = raiseHandBtn.className;
       
       // åˆ‡æ¢ä¸¾æ‰‹çŠ¶æ€ï¼ˆæ¿€æ´»/å–æ¶ˆï¼‰
       if(raiseHandBtn.classList.contains('bg-blue-500')) {
         // å¦‚æœå½“å‰æ˜¯ä¸¾æ‰‹çŠ¶æ€ï¼Œåˆ™å–æ¶ˆä¸¾æ‰‹
         raiseHandBtn.className = 'w-10 h-10 rounded-full bg-black bg-opacity-50 flex items-center justify-center hover:bg-opacity-70 transition';
         raiseHandBtn.innerHTML = '<i class="fa fa-hand-paper"></i>';
         alert('æ‚¨å·²å–æ¶ˆä¸¾æ‰‹');
       } else {
         // è®¾ç½®ä¸ºä¸¾æ‰‹çŠ¶æ€
         raiseHandBtn.className = 'w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center hover:bg-opacity-70 transition';
         raiseHandBtn.innerHTML = '<i class="fa fa-hand-paper"></i>';
         alert('æ‚¨å·²ä¸¾æ‰‹ï¼Œè¯·ç­‰å¾…ä¸»æŒäººå“åº”');
       }
     });
   }

});
</script>

</body>
</html>